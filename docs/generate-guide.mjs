/**
 * Classpet ì‚¬ìš©ê°€ì´ë“œ .docx ìƒì„± ìŠ¤í¬ë¦½íŠ¸
 *
 * ì‹¤í–‰: cd docs && node generate-guide.mjs
 * ì¶œë ¥: docs/classpet-ì‚¬ìš©ê°€ì´ë“œ.docx
 */

import fs from "fs";
import {
  Document, Packer, Paragraph, TextRun, Table, TableRow, TableCell,
  Header, Footer, AlignmentType, LevelFormat, HeadingLevel,
  BorderStyle, WidthType, ShadingType, VerticalAlign,
  PageNumber, PageBreak, ExternalHyperlink, TabStopType, TabStopPosition
} from "docx";

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// 1. ìƒ‰ìƒ / ìŠ¤íƒ€ì¼ ìƒìˆ˜
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const C = {
  primary: "5B7ED9",
  primaryLight: "7C9EF5",
  purple: "A78BFA",
  mint: "7CE0A3",
  dark: "1F2937",
  body: "374151",
  muted: "999999",
  tipBg: "FFF9E6",
  tipBorder: "7CE0A3",
  white: "FFFFFF",
  lightGray: "F3F4F6",
  tableBorder: "D1D5DB",
};

const FONT = "Malgun Gothic";
const FONT_EN = "Arial";
const PAGE_WIDTH_DXA = 9360; // Letter ìš©ì§€ 1ì¸ì¹˜ ë§ˆì§„ ê¸°ì¤€

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// 2. í—¬í¼ í•¨ìˆ˜
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

/** ë¹ˆ ì¤„ */
function emptyLine(size = 20) {
  return new Paragraph({ spacing: { after: size }, children: [] });
}

/** H1: 18pt Bold, primary color + í•˜ë‹¨ ìˆ˜í‰ì„  */
function h1(text) {
  return [
    new Paragraph({
      spacing: { before: 400, after: 100 },
      children: [new TextRun({ text, bold: true, color: C.primary, size: 36, font: FONT })],
    }),
    new Paragraph({
      spacing: { after: 200 },
      border: { bottom: { style: BorderStyle.SINGLE, size: 6, color: C.primary } },
      children: [],
    }),
  ];
}

/** H2: 14pt Bold, primary color */
function h2(text) {
  return new Paragraph({
    spacing: { before: 300, after: 150 },
    children: [new TextRun({ text, bold: true, color: C.primary, size: 28, font: FONT })],
  });
}

/** H3: 12pt Bold, dark color */
function h3(text) {
  return new Paragraph({
    spacing: { before: 240, after: 120 },
    children: [new TextRun({ text, bold: true, color: C.dark, size: 24, font: FONT })],
  });
}

/** ë³¸ë¬¸ í…ìŠ¤íŠ¸ (TextRun ë°°ì—´) */
function body(runs, opts = {}) {
  const children = typeof runs === "string"
    ? [new TextRun({ text: runs, size: 22, font: FONT, color: C.body })]
    : runs.map(r => typeof r === "string"
      ? new TextRun({ text: r, size: 22, font: FONT, color: C.body })
      : new TextRun({ size: 22, font: FONT, color: C.body, ...r }));
  return new Paragraph({
    spacing: { after: 120, ...opts.spacing },
    alignment: opts.alignment,
    indent: opts.indent,
    children,
  });
}

/** Bold í‚¤ì›Œë“œ ì‚½ì… í—¬í¼ */
function b(text) {
  return { text, bold: true, color: C.dark };
}

/** TIP ë°•ìŠ¤ - ì¢Œì¸¡ ë¯¼íŠ¸ì„  + ì—°ë…¸ë€ ë°°ê²½ */
function tipBox(lines) {
  const items = Array.isArray(lines) ? lines : [lines];
  return items.map((line, i) =>
    new Paragraph({
      spacing: { before: i === 0 ? 160 : 0, after: i === items.length - 1 ? 160 : 40 },
      indent: { left: 360 },
      border: { left: { style: BorderStyle.SINGLE, size: 12, color: C.tipBorder } },
      shading: { fill: C.tipBg, type: ShadingType.CLEAR },
      children: [
        ...(i === 0 ? [new TextRun({ text: "TIP  ", bold: true, size: 22, font: FONT, color: C.mint })] : []),
        ...(typeof line === "string"
          ? [new TextRun({ text: line, size: 22, font: FONT, color: C.body })]
          : line.map(r => typeof r === "string"
            ? new TextRun({ text: r, size: 22, font: FONT, color: C.body })
            : new TextRun({ size: 22, font: FONT, color: C.body, ...r }))),
      ],
    })
  );
}

/** í‘œ ìƒì„± */
function createTable(headers, rows, colWidths) {
  const border = { style: BorderStyle.SINGLE, size: 1, color: C.tableBorder };
  const cellBorders = { top: border, bottom: border, left: border, right: border };

  const totalCols = headers.length;
  const widths = colWidths || Array(totalCols).fill(Math.floor(PAGE_WIDTH_DXA / totalCols));

  const headerRow = new TableRow({
    tableHeader: true,
    children: headers.map((h, i) =>
      new TableCell({
        borders: cellBorders,
        width: { size: widths[i], type: WidthType.DXA },
        shading: { fill: C.primaryLight, type: ShadingType.CLEAR },
        verticalAlign: VerticalAlign.CENTER,
        children: [new Paragraph({
          alignment: AlignmentType.CENTER,
          spacing: { before: 60, after: 60 },
          children: [new TextRun({ text: h, bold: true, color: C.white, size: 22, font: FONT })],
        })],
      })
    ),
  });

  const dataRows = rows.map(row =>
    new TableRow({
      children: row.map((cell, i) =>
        new TableCell({
          borders: cellBorders,
          width: { size: widths[i], type: WidthType.DXA },
          verticalAlign: VerticalAlign.CENTER,
          children: [new Paragraph({
            spacing: { before: 40, after: 40 },
            indent: { left: 80 },
            children: typeof cell === "string"
              ? [new TextRun({ text: cell, size: 22, font: FONT, color: C.body })]
              : cell.map(r => typeof r === "string"
                ? new TextRun({ text: r, size: 22, font: FONT, color: C.body })
                : new TextRun({ size: 22, font: FONT, color: C.body, ...r })),
          })],
        })
      ),
    })
  );

  return new Table({
    columnWidths: widths,
    rows: [headerRow, ...dataRows],
  });
}

/** STEP ë°•ìŠ¤ (ë„˜ë²„ ê°•ì¡°) */
function step(num, title) {
  return new Paragraph({
    spacing: { before: 240, after: 100 },
    children: [
      new TextRun({ text: `STEP ${num}. `, bold: true, color: C.primary, size: 24, font: FONT }),
      new TextRun({ text: title, bold: true, color: C.dark, size: 24, font: FONT }),
    ],
  });
}

/** ì‹œë‚˜ë¦¬ì˜¤ ë¸”ë¡ */
function scenario(title, situation, steps) {
  const out = [];
  out.push(h3(title));
  out.push(body([{ text: "ìƒí™©: ", bold: true }, situation]));
  steps.forEach((s, i) => {
    out.push(body([{ text: `${i + 1}. `, bold: true }, s], { indent: { left: 360 } }));
  });
  return out;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// 3. ì„¹ì…˜ë³„ ìƒì„± í•¨ìˆ˜
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

/** í‘œì§€ */
function createCoverPage() {
  return {
    properties: {
      titlePage: true,
      page: {
        margin: { top: 1440, right: 1440, bottom: 1440, left: 1440 },
      },
    },
    children: [
      emptyLine(800),
      emptyLine(800),
      emptyLine(800),
      new Paragraph({
        alignment: AlignmentType.CENTER,
        spacing: { after: 200 },
        children: [new TextRun({ text: "ğŸ¾", size: 80, font: FONT })],
      }),
      emptyLine(100),
      new Paragraph({
        alignment: AlignmentType.CENTER,
        spacing: { after: 100 },
        children: [new TextRun({ text: "Classpet", bold: true, color: C.primary, size: 72, font: FONT_EN })],
      }),
      new Paragraph({
        alignment: AlignmentType.CENTER,
        spacing: { after: 400 },
        children: [new TextRun({ text: "ìš°ë¦¬ ë°˜ í« í‚¤ìš°ê¸° í”„ë¡œì íŠ¸", color: C.purple, size: 32, font: FONT })],
      }),
      new Paragraph({
        alignment: AlignmentType.CENTER,
        border: { top: { style: BorderStyle.SINGLE, size: 4, color: C.primaryLight } },
        spacing: { before: 400, after: 200 },
        children: [],
      }),
      new Paragraph({
        alignment: AlignmentType.CENTER,
        spacing: { after: 100 },
        children: [new TextRun({ text: "ì‚¬ìš© ê°€ì´ë“œ", bold: true, color: C.dark, size: 40, font: FONT })],
      }),
      new Paragraph({
        alignment: AlignmentType.CENTER,
        spacing: { after: 80 },
        children: [new TextRun({ text: "êµì‚¬ ëª¨ë“œ + í•™ìƒ ëª¨ë“œ í†µí•© ì•ˆë‚´ì„œ", color: C.body, size: 24, font: FONT })],
      }),
      emptyLine(400),
      new Paragraph({
        alignment: AlignmentType.CENTER,
        spacing: { after: 80 },
        children: [new TextRun({ text: "ë² íƒ€ ë²„ì „ v1.0", color: C.muted, size: 20, font: FONT })],
      }),
      new Paragraph({
        alignment: AlignmentType.CENTER,
        spacing: { after: 80 },
        children: [new TextRun({ text: "2026ë…„ 2ì›”", color: C.muted, size: 20, font: FONT })],
      }),
    ],
  };
}

/** ëª©ì°¨ (ìˆ˜ë™) */
function createTocSection() {
  const out = [];
  out.push(...h1("ëª©ì°¨"));
  const tocItems = [
    ["0.", "ì‚¬ì „ ì¤€ë¹„: í™ˆ í™”ë©´ì— ì¶”ê°€í•˜ê¸°", "3"],
    ["1.", "ì£¼ìš” ê¸°ëŠ¥ í•œëˆˆì— ë³´ê¸°", "4"],
    ["2.", "ì‹œì‘í•˜ê¸° (ìµœì´ˆ 1íšŒ ì„¤ì •)", "5"],
    ["3.", "êµì‚¬ ëª¨ë“œ ìƒì„¸ ì‚¬ìš©ë²•", "7"],
    ["4.", "í•™ìƒ ëª¨ë“œ ìƒì„¸ ì‚¬ìš©ë²•", "12"],
    ["5.", "ì‹¤ì‹œê°„ ì—°ë™ ì‹œìŠ¤í…œ", "15"],
    ["6.", "í« ì„±ì¥ ì‹œìŠ¤í…œ", "17"],
    ["7.", "ì‹¤ì œ ìˆ˜ì—… ì‹œë‚˜ë¦¬ì˜¤", "19"],
    ["8.", "FAQ", "21"],
    ["9.", "ë² íƒ€ í…ŒìŠ¤íŠ¸ ì•ˆë‚´", "23"],
  ];
  tocItems.forEach(([num, title, page]) => {
    out.push(new Paragraph({
      spacing: { after: 100 },
      tabStops: [
        { type: TabStopType.RIGHT, position: PAGE_WIDTH_DXA },
      ],
      children: [
        new TextRun({ text: `${num}  `, bold: true, size: 24, font: FONT, color: C.primary }),
        new TextRun({ text: title, size: 24, font: FONT, color: C.dark }),
        new TextRun({ text: `\t${page}`, size: 24, font: FONT, color: C.muted }),
      ],
    }));
  });
  return out;
}

/** ì„¹ì…˜ 0: ì‚¬ì „ ì¤€ë¹„ */
function createSection0() {
  const out = [];
  out.push(new Paragraph({ children: [new PageBreak()] }));
  out.push(...h1("0. ì‚¬ì „ ì¤€ë¹„: í™ˆ í™”ë©´ì— ì¶”ê°€í•˜ê¸°"));
  out.push(body("Classpetì€ ë³„ë„ ì•± ì„¤ì¹˜ ì—†ì´ ì›¹ ë¸Œë¼ìš°ì €ì—ì„œ ë°”ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì›¹ì•±(PWA)ì…ë‹ˆë‹¤."));
  out.push(body("í™ˆ í™”ë©´ì— ì¶”ê°€í•˜ë©´ ì¼ë°˜ ì•±ì²˜ëŸ¼ í¸ë¦¬í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."));
  out.push(emptyLine());

  out.push(h3("ì ‘ì† ì£¼ì†Œ"));
  out.push(new Paragraph({
    spacing: { after: 160 },
    children: [
      new ExternalHyperlink({
        children: [new TextRun({ text: "https://classpet.netlify.app", style: "Hyperlink", size: 24, font: FONT_EN })],
        link: "https://classpet.netlify.app",
      }),
    ],
  }));

  out.push(h3("iOS (ì•„ì´íŒ¨ë“œ/ì•„ì´í°)"));
  out.push(body([b("1. "), "Safarië¡œ ìœ„ ì£¼ì†Œì— ì ‘ì†í•©ë‹ˆë‹¤."]));
  out.push(body([b("2. "), "í•˜ë‹¨ ", b("ê³µìœ  ë²„íŠ¼ (â–¡â†‘)"), "ì„ íƒ­í•©ë‹ˆë‹¤."]));
  out.push(body([b("3. "), b("'í™ˆ í™”ë©´ì— ì¶”ê°€'"), "ë¥¼ ì„ íƒí•©ë‹ˆë‹¤."]));
  out.push(body([b("4. "), "'ì¶”ê°€'ë¥¼ íƒ­í•˜ë©´ í™ˆ í™”ë©´ì— Classpet ì•„ì´ì½˜ì´ ìƒê¹ë‹ˆë‹¤."]));

  out.push(h3("Android (íƒœë¸”ë¦¿/ìŠ¤ë§ˆíŠ¸í°)"));
  out.push(body([b("1. "), "Chromeìœ¼ë¡œ ìœ„ ì£¼ì†Œì— ì ‘ì†í•©ë‹ˆë‹¤."]));
  out.push(body([b("2. "), "ìƒë‹¨ ", b("ì  ì„¸ ê°œ ë©”ë‰´ (â‹®)"), "ë¥¼ íƒ­í•©ë‹ˆë‹¤."]));
  out.push(body([b("3. "), b("'í™ˆ í™”ë©´ì— ì¶”ê°€'"), "ë¥¼ ì„ íƒí•©ë‹ˆë‹¤."]));
  out.push(body([b("4. "), "'ì¶”ê°€'ë¥¼ íƒ­í•˜ë©´ ì™„ë£Œë©ë‹ˆë‹¤."]));

  out.push(...tipBox([
    "í™ˆ í™”ë©´ì— ì¶”ê°€í•˜ë©´ ì£¼ì†Œì°½ ì—†ì´ ì „ì²´ í™”ë©´ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆì–´ ìˆ˜ì—… ì¤‘ í›¨ì”¬ í¸ë¦¬í•©ë‹ˆë‹¤.",
    "í•™ìƒìš© íƒœë¸”ë¦¿ì—ë„ ë¯¸ë¦¬ í™ˆ í™”ë©´ì— ì¶”ê°€í•´ ë‘ë©´ ì¢‹ìŠµë‹ˆë‹¤.",
  ]));

  return out;
}

/** ì„¹ì…˜ 1: ì£¼ìš” ê¸°ëŠ¥ í•œëˆˆì— ë³´ê¸° */
function createSection1() {
  const out = [];
  out.push(new Paragraph({ children: [new PageBreak()] }));
  out.push(...h1("1. ì£¼ìš” ê¸°ëŠ¥ í•œëˆˆì— ë³´ê¸°"));
  out.push(body("Classpetì€ êµì‚¬ì™€ í•™ìƒì´ í•¨ê»˜ ì‚¬ìš©í•˜ëŠ” í•™ê¸‰ ê´€ë¦¬ ì›¹ì•±ì…ë‹ˆë‹¤."));
  out.push(emptyLine());

  out.push(createTable(
    ["êµ¬ë¶„", "ê¸°ëŠ¥", "ì„¤ëª…"],
    [
      [
        [b("êµì‚¬")],
        "ëŒ€ì‹œë³´ë“œ",
        "í•™ê¸‰ ì „ì²´ í˜„í™©ì„ í•œëˆˆì— íŒŒì•…",
      ],
      [
        [b("êµì‚¬")],
        "ë¹ ë¥¸ ì¹­ì°¬",
        "í”Œë¡œíŒ… ë²„íŠ¼ìœ¼ë¡œ ì¦‰ì‹œ ì¹­ì°¬ (ì‹¤ì‹œê°„ ì•Œë¦¼)",
      ],
      [
        [b("êµì‚¬")],
        "í« ë†ì¥",
        "í•™ìƒ í« ì„±ì¥ ìƒíƒœë¥¼ í•œëˆˆì— í™•ì¸",
      ],
      [
        [b("êµì‚¬")],
        "ê°ì • ì²´í¬ & ì±„íŒ…",
        "í•™ìƒ ê°ì • í™•ì¸ + 1:1 ì‹¤ì‹œê°„ ëŒ€í™”",
      ],
      [
        [b("êµì‚¬")],
        "ì‹œê°„í‘œ",
        "ìš”ì¼ë³„ ì‹œê°„í‘œ ê´€ë¦¬",
      ],
      [
        [b("êµì‚¬")],
        "í†µê³„",
        "ì¹­ì°¬/ê°ì •/í™œë™ ë°ì´í„° ë¶„ì„",
      ],
      [
        [b("êµì‚¬")],
        "ë½‘ê¸° & íƒ€ì´ë¨¸",
        "ëœë¤ ë½‘ê¸° + ìˆ˜ì—… íƒ€ì´ë¨¸",
      ],
      [
        [b("êµì‚¬")],
        "ì„¤ì •",
        "í•™ìƒ ê´€ë¦¬, í•™ê¸‰ì½”ë“œ, ë°ì´í„° ë°±ì—…",
      ],
      [
        [b("í•™ìƒ")],
        "ë‚´ í«",
        "ì¹­ì°¬ë°›ìœ¼ë©´ í«ì´ ì‹¤ì‹œê°„ ì„±ì¥",
      ],
      [
        [b("í•™ìƒ")],
        "ê°ì • í‘œí˜„ & ì±„íŒ…",
        "ì˜¤ëŠ˜ ê°ì • ì„ íƒ + ì„ ìƒë‹˜ê³¼ ëŒ€í™”",
      ],
      [
        [b("í•™ìƒ")],
        "ì¹­ì°¬ ì•Œë¦¼",
        "ì„ ìƒë‹˜ ì¹­ì°¬ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ìˆ˜ì‹ ",
      ],
      [
        [b("í•™ìƒ")],
        "ì‹œê°„í‘œ / ì»¬ë ‰ì…˜",
        "ì˜¤ëŠ˜ ì‹œê°„í‘œ + í« ë„ê°",
      ],
    ],
    [1800, 2400, 5160]
  ));

  out.push(...tipBox([
    "êµì‚¬ì™€ í•™ìƒì˜ í™”ë©´ì€ ì™„ì „íˆ ë¶„ë¦¬ë˜ì–´ ìˆì–´, í•™ìƒì´ êµì‚¬ ê¸°ëŠ¥ì— ì ‘ê·¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.",
  ]));

  return out;
}

/** ì„¹ì…˜ 2: ì‹œì‘í•˜ê¸° */
function createSection2() {
  const out = [];
  out.push(new Paragraph({ children: [new PageBreak()] }));
  out.push(...h1("2. ì‹œì‘í•˜ê¸° (ìµœì´ˆ 1íšŒ ì„¤ì •)"));
  out.push(body("ì²˜ìŒ ì‚¬ìš©í•  ë•Œ ì•„ë˜ 3ë‹¨ê³„ë¥¼ ì§„í–‰í•©ë‹ˆë‹¤. í•œë²ˆ ì„¤ì •í•˜ë©´ ì´í›„ì—ëŠ” ë°”ë¡œ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤."));
  out.push(emptyLine());

  // STEP 1
  out.push(step(1, "êµì‚¬ ë¡œê·¸ì¸"));
  out.push(body("Classpetì— ì ‘ì†í•˜ë©´ ë¡œê·¸ì¸ ì„ íƒ í™”ë©´ì´ ë‚˜ì˜µë‹ˆë‹¤."));
  out.push(body([b("'êµì‚¬ë¡œ ì‹œì‘í•˜ê¸°'"), "ë¥¼ ì„ íƒí•œ í›„, ", b("Google ê³„ì •"), "ìœ¼ë¡œ ë¡œê·¸ì¸í•©ë‹ˆë‹¤."]));
  out.push(body([b("ë² íƒ€ ì ‘ê·¼ ì½”ë“œ"), "ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤: ", { text: "classpet2026", bold: true, color: C.primary }]));
  out.push(...tipBox(["Google ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸í•˜ë©´ ë°ì´í„°ê°€ ìë™ìœ¼ë¡œ í´ë¼ìš°ë“œì— ì €ì¥ë©ë‹ˆë‹¤."]));

  // STEP 2
  out.push(step(2, "í•™ê¸‰ ë§Œë“¤ê¸° & í•™ìƒ ë“±ë¡"));
  out.push(body([b("1. "), "ë¡œê·¸ì¸ í›„ ", b("'í•™ê¸‰ ë§Œë“¤ê¸°'"), " ë²„íŠ¼ì„ íƒ­í•©ë‹ˆë‹¤."]));
  out.push(body([b("2. "), "í•™ê¸‰ ì´ë¦„(ì˜ˆ: 6í•™ë…„ 3ë°˜)ì„ ì…ë ¥í•©ë‹ˆë‹¤."]));
  out.push(body([b("3. "), "í•™ìƒ ì´ë¦„ì„ í•œ ì¤„ì— í•˜ë‚˜ì”© ì…ë ¥í•˜ê±°ë‚˜, ", b("ì—‘ì…€ì—ì„œ ë³µì‚¬Â·ë¶™ì—¬ë„£ê¸°"), "í•©ë‹ˆë‹¤."]));
  out.push(body([b("4. "), b("'í•™ê¸‰ ìƒì„±'"), "ì„ íƒ­í•˜ë©´ í•™ìƒ ëª©ë¡ì´ ìë™ìœ¼ë¡œ ë§Œë“¤ì–´ì§‘ë‹ˆë‹¤."]));
  out.push(...tipBox([
    "í•™ìƒ ì´ë¦„ì€ ì¶œì„ë¶€ ìˆœì„œëŒ€ë¡œ ì…ë ¥í•˜ë©´ ë²ˆí˜¸ê°€ ìë™ ë°°ì •ë©ë‹ˆë‹¤.",
    "ë‚˜ì¤‘ì— ì„¤ì • > í•™ìƒ ê´€ë¦¬ì—ì„œ ì¶”ê°€/ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
  ]));

  // STEP 3
  out.push(step(3, "í•™ê¸‰ì½”ë“œ ê³µìœ  (QR / ìˆ˜ë™)"));
  out.push(body("í•™ê¸‰ì„ ë§Œë“¤ë©´ í•™ê¸‰ì½”ë“œ(6ìë¦¬)ê°€ ìë™ ìƒì„±ë©ë‹ˆë‹¤."));
  out.push(body([b("1. "), "ì„¤ì • ë©”ë‰´ì—ì„œ ", b("í•™ê¸‰ì½”ë“œ"), "ë¥¼ í™•ì¸í•©ë‹ˆë‹¤."]));
  out.push(body([b("2. "), "í•™ìƒì—ê²Œ ì½”ë“œë¥¼ ì•Œë ¤ì£¼ê±°ë‚˜, QR ì½”ë“œë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤."]));
  out.push(body([b("3. "), "í•™ìƒì€ ", b("'í•™ìƒìœ¼ë¡œ ì‹œì‘í•˜ê¸°'"), " â†’ í•™ê¸‰ì½”ë“œ ì…ë ¥ â†’ ìê¸° ë²ˆí˜¸ ì„ íƒ â†’ PIN ì„¤ì • ìˆœì„œë¡œ ë¡œê·¸ì¸í•©ë‹ˆë‹¤."]));
  out.push(...tipBox([
    "í•™ê¸‰ì½”ë“œëŠ” ì„¤ì •ì—ì„œ ì–¸ì œë“  ì¬ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
    "PINì€ í•™ìƒì´ ì²˜ìŒ ë¡œê·¸ì¸í•  ë•Œ ì§ì ‘ 4ìë¦¬ ìˆ«ìë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.",
  ]));

  return out;
}

/** ì„¹ì…˜ 3: êµì‚¬ ëª¨ë“œ ìƒì„¸ ì‚¬ìš©ë²• */
function createSection3() {
  const out = [];
  out.push(new Paragraph({ children: [new PageBreak()] }));
  out.push(...h1("3. êµì‚¬ ëª¨ë“œ ìƒì„¸ ì‚¬ìš©ë²•"));
  out.push(body("êµì‚¬ ëª¨ë“œì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ëª¨ë“  ê¸°ëŠ¥ì„ ì•ˆë‚´í•©ë‹ˆë‹¤."));

  // 3-1 ëŒ€ì‹œë³´ë“œ
  out.push(h2("3-1. ëŒ€ì‹œë³´ë“œ"));
  out.push(body("ë¡œê·¸ì¸ í›„ ê°€ì¥ ë¨¼ì € ë³´ì´ëŠ” ë©”ì¸ í™”ë©´ì…ë‹ˆë‹¤."));
  out.push(body([b("í•™ê¸‰ ì „ì²´ í˜„í™©"), "ì„ í•œëˆˆì— íŒŒì•…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."]));
  out.push(emptyLine());
  out.push(body([b("ì£¼ìš” ì •ë³´:")]));
  out.push(body("  - ì „ì²´ í•™ìƒ ìˆ˜ ë° ì˜¤ëŠ˜ ê°ì • ì²´í¬ í˜„í™©", { indent: { left: 360 } }));
  out.push(body("  - ì˜¤ëŠ˜ì˜ ì¹­ì°¬ ê±´ìˆ˜", { indent: { left: 360 } }));
  out.push(body("  - ìµœê·¼ ê°ì • í‘œí˜„ ì•Œë¦¼ (ì½ì§€ ì•Šì€ í•­ëª©ì— ë°°ì§€ í‘œì‹œ)", { indent: { left: 360 } }));
  out.push(body("  - í•™ìƒë³„ í« ë ˆë²¨ ìš”ì•½", { indent: { left: 360 } }));

  // 3-2 ë¹ ë¥¸ ì¹­ì°¬
  out.push(h2("3-2. ë¹ ë¥¸ ì¹­ì°¬ (í”Œë¡œíŒ… ë²„íŠ¼)"));
  out.push(body("í™”ë©´ ìš°í•˜ë‹¨ì˜ í”Œë¡œíŒ… ë²„íŠ¼(+)ì„ íƒ­í•˜ë©´ ë¹ ë¥¸ ì¹­ì°¬ ëª¨ë“œê°€ ì—´ë¦½ë‹ˆë‹¤."));
  out.push(emptyLine());
  out.push(body([b("ì‚¬ìš© ë°©ë²•:")]));
  out.push(body([b("1. "), "ì¹­ì°¬í•  ", b("í•™ìƒì„ ì„ íƒ"), "í•©ë‹ˆë‹¤. (ë³µìˆ˜ ì„ íƒ ê°€ëŠ¥)"]));
  out.push(body([b("2. "), "ì¹­ì°¬ ", b("ì¹´í…Œê³ ë¦¬"), "ë¥¼ ì„ íƒí•©ë‹ˆë‹¤."]));
  out.push(emptyLine());

  out.push(createTable(
    ["ì¹´í…Œê³ ë¦¬", "ì•„ì´ì½˜", "íšë“ EXP"],
    [
      ["ìê¸°ê´€ë¦¬", "ğŸ¯", "10"],
      ["ì§€ì‹ì •ë³´", "ğŸ“š", "10"],
      ["ì°½ì˜ì ì‚¬ê³ ", "ğŸ’¡", "10"],
      ["ì‹¬ë¯¸ì ê°ì„±", "ğŸ¨", "10"],
      ["í˜‘ë ¥ì ì†Œí†µ", "ğŸ¤", "10"],
      ["ê³µë™ì²´", "ğŸ ", "10"],
    ],
    [3500, 2430, 3430]
  ));

  out.push(emptyLine());
  out.push(body([b("3. "), "í•„ìš”ì‹œ ì¹­ì°¬ ë©”ì‹œì§€ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤. (ì„ íƒ ì‚¬í•­)"]));
  out.push(body([b("4. "), b("'ì¹­ì°¬í•˜ê¸°'"), "ë¥¼ íƒ­í•˜ë©´ ì¦‰ì‹œ ë°˜ì˜ë©ë‹ˆë‹¤."]));
  out.push(emptyLine());
  out.push(body([b("ê²°ê³¼: "), "ì„ íƒí•œ í•™ìƒì˜ í«ì— ê²½í—˜ì¹˜(EXP)ê°€ ì¶”ê°€ë˜ê³ , í•™ìƒ ê¸°ê¸°ì— ", b("ì‹¤ì‹œê°„ ì¹­ì°¬ ì•Œë¦¼"), "ì´ í‘œì‹œë©ë‹ˆë‹¤."]));
  out.push(...tipBox([
    "ì—¬ëŸ¬ í•™ìƒì„ í•œêº¼ë²ˆì— ì„ íƒí•˜ì—¬ ë™ì‹œì— ì¹­ì°¬í•  ìˆ˜ ìˆì–´ ìˆ˜ì—… ì¤‘ ë¹ ë¥´ê²Œ í™œìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.",
    "10ëª… ì´ˆê³¼ ì„ íƒ ì‹œ í™•ì¸ ëŒ€í™”ìƒìê°€ í‘œì‹œë©ë‹ˆë‹¤.",
  ]));

  // 3-3 í« ë†ì¥
  out.push(h2("3-3. í« ë†ì¥"));
  out.push(body("í•™ê¸‰ ì „ì²´ í•™ìƒì˜ í« ì„±ì¥ ìƒíƒœë¥¼ í•œëˆˆì— í™•ì¸í•  ìˆ˜ ìˆëŠ” í™”ë©´ì…ë‹ˆë‹¤."));
  out.push(body("ê° í•™ìƒì˜ í« ì´ëª¨ì§€, ë ˆë²¨, ì„±ì¥ ë‹¨ê³„ê°€ ì¹´ë“œ í˜•íƒœë¡œ í‘œì‹œë©ë‹ˆë‹¤."));
  out.push(body("í•™ìƒ ì¹´ë“œë¥¼ íƒ­í•˜ë©´ í•´ë‹¹ í•™ìƒì˜ ìƒì„¸ ì •ë³´ í™”ë©´ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤."));

  // 3-4 ê°ì • ì²´í¬ & ê°ì • ì±„íŒ…
  out.push(h2("3-4. ê°ì • ì²´í¬ & ê°ì • ì±„íŒ…"));
  out.push(body("í•™ìƒë“¤ì˜ ì˜¤ëŠ˜ ê°ì • ìƒíƒœë¥¼ í™•ì¸í•˜ê³ , 1:1ë¡œ ëŒ€í™”í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤."));
  out.push(emptyLine());
  out.push(body([b("ê°ì • ì¢…ë¥˜ (5ë‹¨ê³„):")]));
  out.push(createTable(
    ["ì•„ì´ì½˜", "ê°ì •", "ìƒ‰ìƒ"],
    [
      ["ğŸ˜„", "ì•„ì£¼ ì¢‹ì•„ìš”", "ì´ˆë¡"],
      ["ğŸ™‚", "ì¢‹ì•„ìš”", "íŒŒë‘"],
      ["ğŸ˜", "ë³´í†µì´ì—ìš”", "ë…¸ë‘"],
      ["ğŸ˜¢", "ì•ˆ ì¢‹ì•„ìš”", "ì£¼í™©"],
      ["ğŸ˜­", "í˜ë“¤ì–´ìš”", "ë¹¨ê°•"],
    ],
    [2000, 4680, 2680]
  ));
  out.push(emptyLine());
  out.push(body([b("í™•ì¸ ë°©ë²•:")]));
  out.push(body([b("1. "), "í•˜ë‹¨ íƒ­ì—ì„œ ", b("'ê°ì •'"), " ë©”ë‰´ë¥¼ ì„ íƒí•©ë‹ˆë‹¤."]));
  out.push(body([b("2. "), "í•™ìƒë³„ ì˜¤ëŠ˜ ê°ì • ìƒíƒœê°€ ì•„ì´ì½˜ìœ¼ë¡œ í‘œì‹œë©ë‹ˆë‹¤."]));
  out.push(body([b("3. "), "í•™ìƒ ì´ë¦„ì„ íƒ­í•˜ë©´ ", b("ê°ì • ì±„íŒ…"), " í™”ë©´ì´ ì—´ë¦½ë‹ˆë‹¤."]));
  out.push(emptyLine());
  out.push(body([b("ê°ì • ì±„íŒ… íë¦„:")]));
  out.push(body("  í•™ìƒì´ ê°ì •ì„ ì„ íƒí•˜ê³  ë©”ì‹œì§€ë¥¼ ì‘ì„±í•˜ë©´, êµì‚¬ í™”ë©´ì— ì‹¤ì‹œê°„ìœ¼ë¡œ ì•Œë¦¼ì´ í‘œì‹œë©ë‹ˆë‹¤.", { indent: { left: 360 } }));
  out.push(body("  êµì‚¬ê°€ ë‹µì¥ì„ ì‘ì„±í•˜ë©´, í•™ìƒ ê¸°ê¸°ì— ì¦‰ì‹œ ë°˜ì˜ë©ë‹ˆë‹¤.", { indent: { left: 360 } }));
  out.push(body([{ text: "  í•™ìƒ ë©”ì‹œì§€ëŠ” í« ë§íˆ¬ë¡œ ë³€í™˜", bold: true }, "ë˜ì–´ êµì‚¬ì—ê²Œ ì „ë‹¬ë©ë‹ˆë‹¤."], { indent: { left: 360 } }));
  out.push(...tipBox([
    "'ì•ˆ ì¢‹ì•„ìš”'ë‚˜ 'í˜ë“¤ì–´ìš”'ë¥¼ ì„ íƒí•œ í•™ìƒì—ê²Œ ë¨¼ì € ì±„íŒ…ì„ ë³´ë‚´ë©´ íš¨ê³¼ì ì…ë‹ˆë‹¤.",
    "ì½ì§€ ì•Šì€ ê°ì • ë©”ì‹œì§€ì—ëŠ” ì•Œë¦¼ ë°°ì§€ê°€ í‘œì‹œë©ë‹ˆë‹¤.",
  ]));

  // 3-5 ì‹œê°„í‘œ
  out.push(h2("3-5. ì‹œê°„í‘œ"));
  out.push(body("ìš”ì¼ë³„ ì‹œê°„í‘œë¥¼ ì„¤ì •í•˜ê³  ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."));
  out.push(body([b("ì„¤ì • ë°©ë²•:")]));
  out.push(body([b("1. "), "í•˜ë‹¨ íƒ­ì—ì„œ ", b("'ì‹œê°„í‘œ'"), "ë¥¼ ì„ íƒí•©ë‹ˆë‹¤."]));
  out.push(body([b("2. "), "ìš”ì¼ì„ ì„ íƒí•œ í›„, êµì‹œë³„ ê³¼ëª©ì„ ì…ë ¥í•©ë‹ˆë‹¤."]));
  out.push(body([b("3. "), "ì €ì¥í•˜ë©´ í•™ìƒ ëª¨ë“œì—ì„œë„ ë™ì¼í•œ ì‹œê°„í‘œê°€ í‘œì‹œë©ë‹ˆë‹¤."]));

  // 3-6 í†µê³„
  out.push(h2("3-6. í†µê³„"));
  out.push(body("í•™ê¸‰ì˜ ì¹­ì°¬, ê°ì •, í™œë™ ë°ì´í„°ë¥¼ ê·¸ë˜í”„ì™€ ìˆ˜ì¹˜ë¡œ ë¶„ì„í•œ í™”ë©´ì…ë‹ˆë‹¤."));
  out.push(body([b("ì£¼ìš” í†µê³„:")]));
  out.push(body("  - ì¹´í…Œê³ ë¦¬ë³„ ì¹­ì°¬ ë¶„í¬", { indent: { left: 360 } }));
  out.push(body("  - ê¸°ê°„ë³„ ì¹­ì°¬ ì¶”ì´", { indent: { left: 360 } }));
  out.push(body("  - í•™ìƒë³„ ê°ì • ë³€í™” ì¶”ì„¸", { indent: { left: 360 } }));
  out.push(body("  - í•™ê¸‰ ì „ì²´ ê°ì • ë¶„í¬", { indent: { left: 360 } }));

  // 3-7 í•™ìƒ ìƒì„¸
  out.push(h2("3-7. í•™ìƒ ìƒì„¸"));
  out.push(body("ê°œë³„ í•™ìƒì˜ ìƒì„¸ ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."));
  out.push(body("ëŒ€ì‹œë³´ë“œë‚˜ í« ë†ì¥ì—ì„œ í•™ìƒì„ íƒ­í•˜ë©´ ì´ë™í•©ë‹ˆë‹¤."));
  out.push(emptyLine());
  out.push(body([b("í™•ì¸ ê°€ëŠ¥í•œ ì •ë³´:")]));
  out.push(body("  - í« ì •ë³´ (ì¢…ë¥˜, ì´ë¦„, ë ˆë²¨, ê²½í—˜ì¹˜)", { indent: { left: 360 } }));
  out.push(body("  - ì¹­ì°¬ ì´ë ¥ (ì¹´í…Œê³ ë¦¬ë³„ ê¸°ë¡)", { indent: { left: 360 } }));
  out.push(body("  - ê°ì • ì´ë ¥ (ë‚ ì§œë³„ ê°ì • ë³€í™”)", { indent: { left: 360 } }));
  out.push(body("  - ë©”ëª¨ ê¸°ëŠ¥ (êµì‚¬ìš© ê°œì¸ ë©”ëª¨)", { indent: { left: 360 } }));

  // 3-8 ì„¤ì •
  out.push(h2("3-8. ì„¤ì •"));
  out.push(body("í•™ê¸‰ ìš´ì˜ì— í•„ìš”í•œ ë‹¤ì–‘í•œ ì„¤ì •ì„ ê´€ë¦¬í•©ë‹ˆë‹¤."));
  out.push(emptyLine());
  out.push(createTable(
    ["ì„¤ì • í•­ëª©", "ì„¤ëª…"],
    [
      [[b("í•™ìƒ ê´€ë¦¬")], "í•™ìƒ ì¶”ê°€, ì‚­ì œ, ì´ë¦„ ìˆ˜ì •"],
      [[b("í•™ê¸‰ì½”ë“œ")], "í•™ê¸‰ì½”ë“œ í™•ì¸ ë° ì¬ìƒì„±"],
      [[b("ë°ì´í„° ë°±ì—…")], "í•™ê¸‰ ë°ì´í„°ë¥¼ JSON íŒŒì¼ë¡œ ë‚´ë³´ë‚´ê¸°/ê°€ì ¸ì˜¤ê¸°"],
      [[b("í•™ê¸‰ ì „í™˜")], "ì—¬ëŸ¬ í•™ê¸‰ì„ ìš´ì˜í•˜ëŠ” ê²½ìš° í•™ê¸‰ ê°„ ì „í™˜"],
      [[b("ë¡œê·¸ì•„ì›ƒ")], "êµì‚¬ ê³„ì • ë¡œê·¸ì•„ì›ƒ"],
    ],
    [3000, 6360]
  ));
  out.push(...tipBox([
    "í•™ìƒ ì‚­ì œ ì‹œ í•´ë‹¹ í•™ìƒì˜ ëª¨ë“  ì¹­ì°¬/ê°ì •/í« ë°ì´í„°ê°€ í•¨ê»˜ ì‚­ì œë©ë‹ˆë‹¤.",
    "ì¤‘ìš”í•œ ë°ì´í„°ëŠ” ë°˜ë“œì‹œ ë°±ì—… í›„ ì§„í–‰í•˜ì„¸ìš”.",
  ]));

  // 3-9 ë½‘ê¸° & íƒ€ì´ë¨¸
  out.push(h2("3-9. ë½‘ê¸° & íƒ€ì´ë¨¸"));
  out.push(body([b("ë½‘ê¸°: "), "í•™ê¸‰ í•™ìƒ ì¤‘ ëœë¤ìœ¼ë¡œ í•œ ëª…(ë˜ëŠ” ì—¬ëŸ¬ ëª…)ì„ ë½‘ëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤."]));
  out.push(body("ë°œí‘œì ì„ ì •, ëª¨ë‘  ë‚˜ëˆ„ê¸° ë“± ìˆ˜ì—… ì¤‘ ë‹¤ì–‘í•˜ê²Œ í™œìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."));
  out.push(emptyLine());
  out.push(body([b("íƒ€ì´ë¨¸: "), "í™œë™ ì‹œê°„ì„ ì„¤ì •í•˜ê³  ì¹´ìš´íŠ¸ë‹¤ìš´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."]));
  out.push(body("ëª¨ë‘  í™œë™, ë°œí‘œ ì‹œê°„ ê´€ë¦¬ ë“±ì— ìœ ìš©í•©ë‹ˆë‹¤."));

  return out;
}

/** ì„¹ì…˜ 4: í•™ìƒ ëª¨ë“œ ìƒì„¸ ì‚¬ìš©ë²• */
function createSection4() {
  const out = [];
  out.push(new Paragraph({ children: [new PageBreak()] }));
  out.push(...h1("4. í•™ìƒ ëª¨ë“œ ìƒì„¸ ì‚¬ìš©ë²•"));
  out.push(body("í•™ìƒì´ ì‚¬ìš©í•˜ëŠ” ëª¨ë“  ê¸°ëŠ¥ì„ ì•ˆë‚´í•©ë‹ˆë‹¤."));

  // 4-1
  out.push(h2("4-1. í•™ìƒ ë¡œê·¸ì¸"));
  out.push(body([b("1. "), "Classpetì— ì ‘ì†í•˜ì—¬ ", b("'í•™ìƒìœ¼ë¡œ ì‹œì‘í•˜ê¸°'"), "ë¥¼ ì„ íƒí•©ë‹ˆë‹¤."]));
  out.push(body([b("2. "), "ì„ ìƒë‹˜ì´ ì•Œë ¤ì¤€ ", b("í•™ê¸‰ì½”ë“œ(6ìë¦¬)"), "ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤."]));
  out.push(body([b("3. "), "ìì‹ ì˜ ", b("ì¶œì„ ë²ˆí˜¸"), "ë¥¼ ì„ íƒí•©ë‹ˆë‹¤."]));
  out.push(body([b("4. "), "ì²˜ìŒ ë¡œê·¸ì¸ ì‹œ ", b("PIN 4ìë¦¬"), "ë¥¼ ì§ì ‘ ì„¤ì •í•©ë‹ˆë‹¤."]));
  out.push(body([b("5. "), "ì´í›„ ë¡œê·¸ì¸ ì‹œì—ëŠ” ë²ˆí˜¸ ì„ íƒ + PIN ì…ë ¥ìœ¼ë¡œ ë°”ë¡œ ì ‘ì†í•©ë‹ˆë‹¤."]));
  out.push(...tipBox([
    "PINì„ ìŠì–´ë²„ë¦° ê²½ìš°, êµì‚¬ê°€ ì„¤ì • ë©”ë‰´ì—ì„œ PINì„ ì´ˆê¸°í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
  ]));

  // 4-2
  out.push(h2("4-2. í« ì„ íƒ & ì´ë¦„ ì§“ê¸°"));
  out.push(body("ì²˜ìŒ ë¡œê·¸ì¸í•˜ë©´ 12ì¢…ì˜ í« ì¤‘ í•˜ë‚˜ë¥¼ ì„ íƒí•©ë‹ˆë‹¤."));
  out.push(emptyLine());
  out.push(createTable(
    ["í« ì¢…ë¥˜", "ì´ëª¨ì§€ (ì•Œ/ì•„ê¸°/ì„±ì¥/ì„±ì²´)", "íŠ¹ì§•"],
    [
      ["ê°•ì•„ì§€", "ğŸ â†’ ğŸ• â†’ ğŸ• â†’ ğŸ¦®", "í¬ìœ ë¥˜"],
      ["ê³ ì–‘ì´", "ğŸ â†’ ğŸ± â†’ ğŸ± â†’ ğŸˆ", "í¬ìœ ë¥˜"],
      ["í† ë¼", "ğŸ â†’ ğŸ° â†’ ğŸ° â†’ ğŸ‡", "í¬ìœ ë¥˜"],
      ["í–„ìŠ¤í„°", "ğŸ â†’ ğŸ¹ â†’ ğŸ¹ â†’ ğŸ¹", "í¬ìœ ë¥˜"],
      ["ì—¬ìš°", "ğŸ â†’ ğŸ¦Š â†’ ğŸ¦Š â†’ ğŸ¦Š", "í¬ìœ ë¥˜"],
      ["ê³°", "ğŸ â†’ ğŸ» â†’ ğŸ» â†’ ğŸ»", "í¬ìœ ë¥˜"],
      ["íŒë‹¤", "ğŸ â†’ ğŸ¼ â†’ ğŸ¼ â†’ ğŸ¼", "í¬ìœ ë¥˜"],
      ["ì‚¬ì", "ğŸ â†’ ğŸ¦ â†’ ğŸ¦ â†’ ğŸ¦", "í¬ìœ ë¥˜"],
      ["ë³‘ì•„ë¦¬", "ğŸ¥š â†’ ğŸ£ â†’ ğŸ¤ â†’ ğŸ“", "ì¡°ë¥˜"],
      ["í­ê·„", "ğŸ¥š â†’ ğŸ§ â†’ ğŸ§ â†’ ğŸ§", "ì¡°ë¥˜"],
      ["ê±°ë¶ì´", "ğŸ¥š â†’ ğŸ¢ â†’ ğŸ¢ â†’ ğŸ¢", "íŒŒì¶©ë¥˜"],
      ["ë“œë˜ê³¤", "âœ¨ â†’ ğŸ‰ â†’ ğŸ‰ â†’ ğŸ‰", "íŒíƒ€ì§€"],
    ],
    [2200, 4560, 2600]
  ));
  out.push(emptyLine());
  out.push(body("í«ì„ ì„ íƒí•œ í›„, ì›í•˜ëŠ” ì´ë¦„ì„ ì§€ì–´ì¤ë‹ˆë‹¤."));
  out.push(body("í«ì€ ì¹­ì°¬ì„ ë°›ì„ìˆ˜ë¡ ê²½í—˜ì¹˜ê°€ ìŒ“ì—¬ ì„±ì¥í•©ë‹ˆë‹¤!"));

  // 4-3
  out.push(h2("4-3. ë©”ì¸ í™”ë©´ (ë‚´ í«)"));
  out.push(body("í•™ìƒ ëª¨ë“œì˜ ë©”ì¸ í™”ë©´ì—ëŠ” ìì‹ ì˜ í«ì´ í¬ê²Œ í‘œì‹œë©ë‹ˆë‹¤."));
  out.push(emptyLine());
  out.push(body([b("í‘œì‹œ ì •ë³´:")]));
  out.push(body("  - í« ì´ëª¨ì§€ (ì„±ì¥ ë‹¨ê³„ì— ë”°ë¼ ë³€í™”)", { indent: { left: 360 } }));
  out.push(body("  - í« ì´ë¦„ & ë ˆë²¨", { indent: { left: 360 } }));
  out.push(body("  - ê²½í—˜ì¹˜ ë°” (ë‹¤ìŒ ë ˆë²¨ê¹Œì§€ ì§„í–‰ë¥ )", { indent: { left: 360 } }));
  out.push(body("  - í« ìƒíƒœ ë©”ì‹œì§€", { indent: { left: 360 } }));
  out.push(emptyLine());
  out.push(body([b("ì‹¤ì‹œê°„ ë°˜ì˜: "), "êµì‚¬ê°€ ì¹­ì°¬í•˜ë©´ í«ì˜ ê²½í—˜ì¹˜ì™€ ë ˆë²¨ì´ ì¦‰ì‹œ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤."]));
  out.push(body("ë ˆë²¨ì—… ì‹œ ì¶•í•˜ ì• ë‹ˆë©”ì´ì…˜ì´ í‘œì‹œë©ë‹ˆë‹¤!"));

  // 4-4
  out.push(h2("4-4. ê°ì • í‘œí˜„ & ì„ ìƒë‹˜ê³¼ ì±„íŒ…"));
  out.push(body("í•˜ë‹¨ íƒ­ì—ì„œ ê°ì • ë©”ë‰´ë¥¼ ì„ íƒí•˜ë©´, ì˜¤ëŠ˜ì˜ ê°ì •ì„ í‘œí˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."));
  out.push(emptyLine());
  out.push(body([b("ì‚¬ìš© ë°©ë²•:")]));
  out.push(body([b("1. "), "5ê°€ì§€ ê°ì • ì•„ì´ì½˜(ğŸ˜„ğŸ™‚ğŸ˜ğŸ˜¢ğŸ˜­) ì¤‘ ì˜¤ëŠ˜ ê¸°ë¶„ì„ ì„ íƒí•©ë‹ˆë‹¤."]));
  out.push(body([b("2. "), "ì„ íƒì ìœ¼ë¡œ ë©”ì‹œì§€ë¥¼ ì‘ì„±í•©ë‹ˆë‹¤. (ì˜ˆ: 'ì˜¤ëŠ˜ ì‹œí—˜ì´ ê±±ì •ë¼ìš”')"]));
  out.push(body([b("3. "), "ì „ì†¡í•˜ë©´ ì„ ìƒë‹˜ì—ê²Œ ì‹¤ì‹œê°„ìœ¼ë¡œ ì „ë‹¬ë©ë‹ˆë‹¤."]));
  out.push(body([b("4. "), "ì„ ìƒë‹˜ì´ ë‹µì¥í•˜ë©´ í™”ë©´ì— ë°”ë¡œ í‘œì‹œë©ë‹ˆë‹¤."]));
  out.push(emptyLine());
  out.push(body([{ text: "í•™ìƒì˜ ë©”ì‹œì§€ëŠ” ìì‹ ì´ ì„ íƒí•œ í«ì˜ ë§íˆ¬ë¡œ ë³€í™˜", bold: true }, "ë˜ì–´ ì¬ë¯¸ìˆê²Œ ì „ë‹¬ë©ë‹ˆë‹¤."]));
  out.push(body("ì˜ˆ) ê°•ì•„ì§€ í«: 'ì˜¤ëŠ˜ ì‹œí—˜ì´ ê±±ì •ë¼ìš” ë©!'"));

  // 4-5
  out.push(h2("4-5. ì¹­ì°¬ ì•Œë¦¼ (ì‹¤ì‹œê°„ ìˆ˜ì‹ )"));
  out.push(body("ì„ ìƒë‹˜ì´ ì¹­ì°¬í•˜ë©´ í•™ìƒ í™”ë©´ì— ì¦‰ì‹œ ì•Œë¦¼ì´ í‘œì‹œë©ë‹ˆë‹¤."));
  out.push(emptyLine());
  out.push(body([b("ì•Œë¦¼ì— í¬í•¨ë˜ëŠ” ì •ë³´:")]));
  out.push(body("  - ì¹­ì°¬ ì¹´í…Œê³ ë¦¬ ì•„ì´ì½˜ (ğŸ¯ğŸ“šğŸ’¡ğŸ¨ğŸ¤ğŸ )", { indent: { left: 360 } }));
  out.push(body("  - ì¹­ì°¬ ë©”ì‹œì§€ (ì„ ìƒë‹˜ì´ ì…ë ¥í•œ ê²½ìš°)", { indent: { left: 360 } }));
  out.push(body("  - íšë“í•œ ê²½í—˜ì¹˜ (+10 EXP)", { indent: { left: 360 } }));
  out.push(...tipBox([
    "ì¹­ì°¬ ì•Œë¦¼ì€ í•™ìƒì´ ì•±ì„ ì—´ê³  ìˆì„ ë•Œ ì‹¤ì‹œê°„ìœ¼ë¡œ ìˆ˜ì‹ ë©ë‹ˆë‹¤.",
    "ì¹­ì°¬ ì´ë ¥ì€ ì¹­ì°¬ íƒ­ì—ì„œ ì–¸ì œë“  ë‹¤ì‹œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
  ]));

  // 4-6
  out.push(h2("4-6. ì‹œê°„í‘œ / í« ì»¬ë ‰ì…˜"));
  out.push(body([b("ì‹œê°„í‘œ: "), "êµì‚¬ê°€ ì„¤ì •í•œ ì‹œê°„í‘œê°€ í•™ìƒ í™”ë©´ì—ë„ ë™ì¼í•˜ê²Œ í‘œì‹œë©ë‹ˆë‹¤."]));
  out.push(body("ì˜¤ëŠ˜ ìš”ì¼ì˜ ìˆ˜ì—…ì´ ìë™ìœ¼ë¡œ í•˜ì´ë¼ì´íŠ¸ë©ë‹ˆë‹¤."));
  out.push(emptyLine());
  out.push(body([b("í« ì»¬ë ‰ì…˜: "), "12ì¢…ì˜ í«ì„ ë„ê° í˜•íƒœë¡œ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤."]));
  out.push(body("ì•„ì§ ì„ íƒí•˜ì§€ ì•Šì€ í«ì€ ì‹¤ë£¨ì—£(?)ìœ¼ë¡œ í‘œì‹œë©ë‹ˆë‹¤."));

  return out;
}

/** ì„¹ì…˜ 5: ì‹¤ì‹œê°„ ì—°ë™ ì‹œìŠ¤í…œ */
function createSection5() {
  const out = [];
  out.push(new Paragraph({ children: [new PageBreak()] }));
  out.push(...h1("5. ì‹¤ì‹œê°„ ì—°ë™ ì‹œìŠ¤í…œ"));
  out.push(body("Classpetì˜ í•µì‹¬ì€ êµì‚¬ì™€ í•™ìƒ ê¸°ê¸° ê°„ì˜ ì‹¤ì‹œê°„ ì—°ë™ì…ë‹ˆë‹¤."));
  out.push(body("ë³„ë„ì˜ ìƒˆë¡œê³ ì¹¨ ì—†ì´, í•œìª½ì—ì„œ ë³€ê²½í•˜ë©´ ë‹¤ë¥¸ ìª½ì— ì¦‰ì‹œ ë°˜ì˜ë©ë‹ˆë‹¤."));
  out.push(emptyLine());

  // 5-1
  out.push(h2("5-1. ì¹­ì°¬ â†’ í•™ìƒ ê¸°ê¸°ì— ì¦‰ì‹œ ì•Œë¦¼"));
  out.push(body([b("íë¦„:")]));
  out.push(body("  1) êµì‚¬ê°€ ë¹ ë¥¸ ì¹­ì°¬ ë²„íŠ¼ìœ¼ë¡œ í•™ìƒì„ ì¹­ì°¬í•©ë‹ˆë‹¤.", { indent: { left: 360 } }));
  out.push(body("  2) Firestoreì— ì¹­ì°¬ ë°ì´í„°ê°€ ì €ì¥ë©ë‹ˆë‹¤.", { indent: { left: 360 } }));
  out.push(body("  3) í•™ìƒ ê¸°ê¸°ê°€ ì‹¤ì‹œê°„ìœ¼ë¡œ ë³€ê²½ì„ ê°ì§€í•©ë‹ˆë‹¤.", { indent: { left: 360 } }));
  out.push(body("  4) í•™ìƒ í™”ë©´ì— ì¹­ì°¬ ì•Œë¦¼ì´ ì¦‰ì‹œ í‘œì‹œë©ë‹ˆë‹¤.", { indent: { left: 360 } }));
  out.push(body("  5) í«ì˜ ê²½í—˜ì¹˜ê°€ ìë™ìœ¼ë¡œ ì¦ê°€í•©ë‹ˆë‹¤.", { indent: { left: 360 } }));

  // 5-2
  out.push(h2("5-2. ê°ì • ì±„íŒ…"));
  out.push(body([b("ì „ì²´ íë¦„:")]));
  out.push(emptyLine());
  out.push(createTable(
    ["ë‹¨ê³„", "í–‰ìœ„ì", "ë™ì‘", "ìƒëŒ€ë°© ë°˜ì‘"],
    [
      ["1", "í•™ìƒ", "ê°ì • ì„ íƒ + ë©”ì‹œì§€ ì‘ì„±", "êµì‚¬ í™”ë©´ì— ì•Œë¦¼ ë°°ì§€ í‘œì‹œ"],
      ["2", "êµì‚¬", "ê°ì • ëª©ë¡ì—ì„œ í™•ì¸", "ë©”ì‹œì§€ë¥¼ í« ë§íˆ¬ë¡œ ìˆ˜ì‹ "],
      ["3", "êµì‚¬", "ë‹µì¥ ì‘ì„± & ì „ì†¡", "í•™ìƒ í™”ë©´ì— ì¦‰ì‹œ í‘œì‹œ"],
      ["4", "í•™ìƒ", "ë‹µì¥ í™•ì¸", "ëŒ€í™” ìƒíƒœê°€ 'ì½ìŒ'ìœ¼ë¡œ ë³€ê²½"],
    ],
    [1200, 1500, 3360, 3300]
  ));
  out.push(emptyLine());
  out.push(body("êµì‚¬ì™€ í•™ìƒ ê°„ì˜ ëŒ€í™”ëŠ” í•´ë‹¹ í•™ìƒì˜ ê°ì • ê¸°ë¡ì— í•¨ê»˜ ì €ì¥ë˜ì–´, ë‚˜ì¤‘ì— ë‹¤ì‹œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."));

  // 5-3
  out.push(h2("5-3. í« ê²½í—˜ì¹˜/ë ˆë²¨ ì‹¤ì‹œê°„ ë™ê¸°í™”"));
  out.push(body("êµì‚¬ê°€ ì¹­ì°¬ì„ ë³´ë‚´ë©´:"));
  out.push(body("  - í« ê²½í—˜ì¹˜ê°€ ì¦‰ì‹œ ì¦ê°€í•©ë‹ˆë‹¤.", { indent: { left: 360 } }));
  out.push(body("  - ë ˆë²¨ì—… ì¡°ê±´ì„ ë§Œì¡±í•˜ë©´ ìë™ìœ¼ë¡œ ë ˆë²¨ì´ ì˜¬ë¼ê°‘ë‹ˆë‹¤.", { indent: { left: 360 } }));
  out.push(body("  - ì„±ì¥ ë‹¨ê³„ê°€ ë³€ê²½ë˜ë©´ í« ì´ëª¨ì§€ê°€ ë°”ë€ë‹ˆë‹¤.", { indent: { left: 360 } }));
  out.push(body("  - í•™ìƒ í™”ë©´ì—ì„œ ì´ ëª¨ë“  ë³€í™”ê°€ ì‹¤ì‹œê°„ìœ¼ë¡œ ë°˜ì˜ë©ë‹ˆë‹¤.", { indent: { left: 360 } }));
  out.push(...tipBox([
    "ì‹¤ì‹œê°„ ë™ê¸°í™”ëŠ” ì¸í„°ë„· ì—°ê²°ì´ í•„ìš”í•©ë‹ˆë‹¤.",
    "ì˜¤í”„ë¼ì¸ ìƒíƒœì—ì„œ ìˆ˜í–‰í•œ ì‘ì—…ì€ ì¸í„°ë„· ì¬ì—°ê²° ì‹œ ìë™ìœ¼ë¡œ ë™ê¸°í™”ë©ë‹ˆë‹¤.",
  ]));

  // 5-4
  out.push(h2("5-4. ì•Œë¦¼ ë°°ì§€ ì‹œìŠ¤í…œ"));
  out.push(body("ì½ì§€ ì•Šì€ í•­ëª©ì´ ìˆìœ¼ë©´ í•´ë‹¹ ë©”ë‰´ ì•„ì´ì½˜ì— ë¹¨ê°„ ë°°ì§€ê°€ í‘œì‹œë©ë‹ˆë‹¤."));
  out.push(emptyLine());
  out.push(createTable(
    ["ëŒ€ìƒ", "ì•Œë¦¼ ë°°ì§€ê°€ í‘œì‹œë˜ëŠ” ê²½ìš°"],
    [
      [[b("êµì‚¬")], "í•™ìƒì´ ìƒˆë¡œìš´ ê°ì •ì„ í‘œí˜„í–ˆì„ ë•Œ"],
      [[b("êµì‚¬")], "í•™ìƒì´ ê°ì • ì±„íŒ…ì— ë©”ì‹œì§€ë¥¼ ë³´ëƒˆì„ ë•Œ"],
      [[b("í•™ìƒ")], "ì„ ìƒë‹˜ì´ ì¹­ì°¬ì„ ë³´ëƒˆì„ ë•Œ"],
      [[b("í•™ìƒ")], "ì„ ìƒë‹˜ì´ ê°ì • ì±„íŒ…ì— ë‹µì¥í–ˆì„ ë•Œ"],
    ],
    [2500, 6860]
  ));

  return out;
}

/** ì„¹ì…˜ 6: í« ì„±ì¥ ì‹œìŠ¤í…œ */
function createSection6() {
  const out = [];
  out.push(new Paragraph({ children: [new PageBreak()] }));
  out.push(...h1("6. í« ì„±ì¥ ì‹œìŠ¤í…œ"));
  out.push(body("í«ì€ ì¹­ì°¬ì„ ë°›ì„ ë•Œë§ˆë‹¤ ê²½í—˜ì¹˜(EXP)ë¥¼ íšë“í•˜ë©°, ì´ 15ë ˆë²¨ê¹Œì§€ ì„±ì¥í•©ë‹ˆë‹¤."));
  out.push(emptyLine());

  out.push(h2("ì„±ì¥ ë‹¨ê³„"));
  out.push(createTable(
    ["ë‹¨ê³„", "ë ˆë²¨ ë²”ìœ„", "ì„¤ëª…"],
    [
      ["ğŸ¥š Egg (ì•Œ)", "ë ˆë²¨ 1", "ì•„ì§ ì•Œ ì†ì— ìˆëŠ” ìƒíƒœ. ì¹­ì°¬ìœ¼ë¡œ ë”°ëœ»í•˜ê²Œ í’ˆì–´ì£¼ì„¸ìš”!"],
      ["ğŸ£ Baby (ì•„ê¸°)", "ë ˆë²¨ 2~4", "ì•Œì—ì„œ ê¹¨ì–´ë‚œ ì•„ê¸° í«. ì•„ì¥ì•„ì¥ ê±·ê¸° ì‹œì‘í•©ë‹ˆë‹¤."],
      ["ğŸŒ± Growing (ì„±ì¥)", "ë ˆë²¨ 5~9", "ì‘¥ì‘¥ ìë¼ëŠ” ì¤‘! í™œë°œí•˜ê²Œ ì›€ì§ì´ê¸° ì‹œì‘í•©ë‹ˆë‹¤."],
      ["â­ Adult (ì„±ì²´)", "ë ˆë²¨ 10~15", "ë‹¤ ìë€ ë©‹ì§„ í«! ìµœê³ ì˜ íŒŒíŠ¸ë„ˆê°€ ë˜ì—ˆìŠµë‹ˆë‹¤."],
    ],
    [2600, 2200, 4560]
  ));

  out.push(emptyLine());
  out.push(h2("ë ˆë²¨ í…Œì´ë¸”"));
  out.push(createTable(
    ["ë ˆë²¨", "í•„ìš” ëˆ„ì  EXP", "ì„±ì¥ ë‹¨ê³„"],
    [
      ["1", "0", "Egg (ì•Œ)"],
      ["2", "50", "Baby"],
      ["3", "120", "Baby"],
      ["4", "200", "Baby"],
      ["5", "300", "Growing"],
      ["6", "420", "Growing"],
      ["7", "560", "Growing"],
      ["8", "720", "Growing"],
      ["9", "900", "Growing"],
      ["10", "1,100", "Adult"],
      ["11", "1,320", "Adult"],
      ["12", "1,560", "Adult"],
      ["13", "1,820", "Adult"],
      ["14", "2,100", "Adult"],
      ["15 (MAX)", "2,400", "Adult (ìµœê³  ë ˆë²¨!)"],
    ],
    [2200, 3580, 3580]
  ));

  out.push(emptyLine());
  out.push(h2("ê²½í—˜ì¹˜ íšë“ ë°©ë²•"));
  out.push(body("ì¹­ì°¬ 1íšŒë‹¹ ê¸°ë³¸ 10 EXPë¥¼ íšë“í•©ë‹ˆë‹¤."));
  out.push(body("ëª¨ë“  ì¹­ì°¬ ì¹´í…Œê³ ë¦¬ì˜ EXPëŠ” ë™ì¼í•©ë‹ˆë‹¤."));
  out.push(emptyLine());
  out.push(body([b("ë ˆë²¨ì—… íŠ¹ë³„ ë©”ì‹œì§€:")]));
  out.push(body("  - ë ˆë²¨ 2 ë„ë‹¬: 'ì•Œì—ì„œ ê¹¨ì–´ë‚¬ì–´ìš”! ğŸ£'", { indent: { left: 360 } }));
  out.push(body("  - ë ˆë²¨ 5 ë„ë‹¬: 'ë¬´ëŸ­ë¬´ëŸ­ ìë¼ê³  ìˆì–´ìš”! ğŸŒ±'", { indent: { left: 360 } }));
  out.push(body("  - ë ˆë²¨ 10 ë„ë‹¬: 'ë‹¤ ìëì–´ìš”! ì¶•í•˜í•´ìš”! ğŸ‰'", { indent: { left: 360 } }));
  out.push(body("  - ë ˆë²¨ 15 ë„ë‹¬: 'ìµœê³  ë ˆë²¨ ë‹¬ì„±! ë§ˆìŠ¤í„°! ğŸ‘‘'", { indent: { left: 360 } }));

  out.push(...tipBox([
    "ë ˆë²¨ 15(MAX)ê¹Œì§€ ì´ 2,400 EXPê°€ í•„ìš”í•©ë‹ˆë‹¤.",
    "ê¸°ë³¸ EXP ê¸°ì¤€ìœ¼ë¡œ ì¹­ì°¬ 240íšŒì— í•´ë‹¹í•©ë‹ˆë‹¤.",
    "í•œ í•™ê¸°(ì•½ 80ì¼) ë™ì•ˆ ë§¤ì¼ 3íšŒ ì¹­ì°¬ì„ ë°›ìœ¼ë©´ ìµœê³  ë ˆë²¨ì— ë„ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!",
  ]));

  return out;
}

/** ì„¹ì…˜ 7: ì‹¤ì œ ìˆ˜ì—… ì‹œë‚˜ë¦¬ì˜¤ */
function createSection7() {
  const out = [];
  out.push(new Paragraph({ children: [new PageBreak()] }));
  out.push(...h1("7. ì‹¤ì œ ìˆ˜ì—… ì‹œë‚˜ë¦¬ì˜¤"));
  out.push(body("Classpetì„ ìˆ˜ì—…ì—ì„œ í™œìš©í•˜ëŠ” êµ¬ì²´ì ì¸ ì˜ˆì‹œì…ë‹ˆë‹¤."));

  // ì‹œë‚˜ë¦¬ì˜¤ 1
  out.push(...scenario(
    "ì‹œë‚˜ë¦¬ì˜¤ 1: í•™ê¸° ì´ˆ ì„¸íŒ… (ì•½ 20ë¶„)",
    "ìƒˆ í•™ê¸° ì²«ë‚ , Classpetì„ ì²˜ìŒ ë„ì…í•©ë‹ˆë‹¤.",
    [
      "êµì‚¬: Google ë¡œê·¸ì¸ â†’ í•™ê¸‰ ë§Œë“¤ê¸° â†’ í•™ìƒ ì´ë¦„ ì…ë ¥ â†’ í•™ê¸‰ì½”ë“œ í™•ì¸",
      "êµì‚¬: í•™ê¸‰ì½”ë“œë¥¼ ì¹ íŒì— ì ê±°ë‚˜, QR ì½”ë“œë¥¼ TVì— ë„ì›ë‹ˆë‹¤.",
      "í•™ìƒ: íƒœë¸”ë¦¿ìœ¼ë¡œ ì ‘ì† â†’ 'í•™ìƒìœ¼ë¡œ ì‹œì‘í•˜ê¸°' â†’ í•™ê¸‰ì½”ë“œ ì…ë ¥ â†’ ë²ˆí˜¸ ì„ íƒ â†’ PIN ì„¤ì •",
      "í•™ìƒ: 12ì¢… í« ì¤‘ ë§ˆìŒì— ë“œëŠ” í« ì„ íƒ â†’ ì´ë¦„ ì§“ê¸°",
      "êµì‚¬: í« ë†ì¥ì—ì„œ ëª¨ë“  í•™ìƒì˜ í«ì´ ë“±ë¡ë˜ì—ˆëŠ”ì§€ í™•ì¸",
      "êµì‚¬: ì‹œë²”ìœ¼ë¡œ ëª‡ ëª…ì—ê²Œ ì¹­ì°¬ ë³´ë‚´ê¸° â†’ í•™ìƒë“¤ì´ ì‹¤ì‹œê°„ ì•Œë¦¼ì„ í™•ì¸í•˜ë©° í™˜í˜¸!",
    ]
  ));

  // ì‹œë‚˜ë¦¬ì˜¤ 2
  out.push(...scenario(
    "ì‹œë‚˜ë¦¬ì˜¤ 2: ì¼ìƒ ì¹­ì°¬ (ìˆ˜ì—… ì¤‘ ìˆ˜ì‹œ)",
    "ìˆ˜ì—… ì¤‘ í•™ìƒì˜ ì¢‹ì€ í–‰ë™ì„ ë°œê²¬í–ˆì„ ë•Œ ì¦‰ì‹œ ì¹­ì°¬í•©ë‹ˆë‹¤.",
    [
      "êµì‚¬: í™”ë©´ ìš°í•˜ë‹¨ í”Œë¡œíŒ… ë²„íŠ¼(+) íƒ­",
      "êµì‚¬: ì¹­ì°¬í•  í•™ìƒ 1~2ëª… ì„ íƒ",
      "êµì‚¬: ì¹´í…Œê³ ë¦¬ ì„ íƒ (ì˜ˆ: ğŸ¤ í˜‘ë ¥ì ì†Œí†µ)",
      "êµì‚¬: (ì„ íƒ) ì¹­ì°¬ ë©”ì‹œì§€ ì…ë ¥ â†’ 'ì¹­ì°¬í•˜ê¸°' íƒ­",
      "í•™ìƒ: íƒœë¸”ë¦¿ì— ì¹­ì°¬ ì•Œë¦¼ì´ ì‹¤ì‹œê°„ í‘œì‹œ â†’ í« ê²½í—˜ì¹˜ ì¦ê°€!",
      "í•™ìƒ: í«ì´ ê¸°ë»í•˜ëŠ” ë¦¬ì•¡ì…˜ í™•ì¸ â†’ í•™ìŠµ ë™ê¸° UP!",
    ]
  ));

  // ì‹œë‚˜ë¦¬ì˜¤ 3
  out.push(...scenario(
    "ì‹œë‚˜ë¦¬ì˜¤ 3: ê°ì • ì²´í¬ì¸ & ì±„íŒ… (ì•„ì¹¨ í™œë™ 10ë¶„)",
    "ì•„ì¹¨ ì‹œê°„ì— í•™ìƒë“¤ì˜ ì˜¤ëŠ˜ ê¸°ë¶„ì„ í™•ì¸í•©ë‹ˆë‹¤.",
    [
      "êµì‚¬: 'ì˜¤ëŠ˜ ê¸°ë¶„ì´ ì–´ë•Œìš”? Classpetì—ì„œ ê°ì •ì„ ì„ íƒí•´ ì£¼ì„¸ìš”.' ì•ˆë‚´",
      "í•™ìƒ: ê°ì • ì•„ì´ì½˜ 5ê°œ ì¤‘ ì˜¤ëŠ˜ ê¸°ë¶„ ì„ íƒ â†’ ë©”ì‹œì§€ ì‘ì„± (ì„ íƒ)",
      "êµì‚¬: ê°ì • ë©”ë‰´ì—ì„œ í•™ìƒë³„ ê°ì • í™•ì¸ (íŠ¹íˆ ğŸ˜¢ğŸ˜­ í•™ìƒ ì£¼ëª©)",
      "êµì‚¬: 'ì•ˆ ì¢‹ì•„ìš”'ë¥¼ ì„ íƒí•œ í•™ìƒì—ê²Œ ì±„íŒ…ìœ¼ë¡œ ë”°ëœ»í•œ ë©”ì‹œì§€ ì „ì†¡",
      "í•™ìƒ: ì„ ìƒë‹˜ ë‹µì¥ì„ í™•ì¸í•˜ê³  ìœ„ë¡œë°›ìŒ",
      "êµì‚¬: í•™ê¸‰ ì „ì²´ ê°ì • ë¶„í¬ë¥¼ í™•ì¸í•˜ì—¬ ì˜¤ëŠ˜ ìˆ˜ì—… ë¶„ìœ„ê¸° íŒŒì•…",
    ]
  ));

  // ì‹œë‚˜ë¦¬ì˜¤ 4
  out.push(...scenario(
    "ì‹œë‚˜ë¦¬ì˜¤ 4: ëª¨ë‘  í™œë™ (ì²´ìœ¡/ë¯¸ìˆ  ë“±)",
    "ëª¨ë‘  í™œë™ í›„ íŒ€ë³„ë¡œ ì¹­ì°¬í•©ë‹ˆë‹¤.",
    [
      "êµì‚¬: ëª¨ë‘  í™œë™ ì¢…ë£Œ í›„, ë¹ ë¥¸ ì¹­ì°¬ ë²„íŠ¼ íƒ­",
      "êµì‚¬: ìš°ìˆ˜ ëª¨ë‘  í•™ìƒ ì „ì› ì„ íƒ (ë³µìˆ˜ ì„ íƒ)",
      "êµì‚¬: ğŸ¤ í˜‘ë ¥ì ì†Œí†µ ë˜ëŠ” ğŸ  ê³µë™ì²´ ì¹´í…Œê³ ë¦¬ ì„ íƒ",
      "êµì‚¬: 'ëª¨ë‘  í™œë™ì„ ì˜ ì´ëŒì—ˆì–´ìš”!' ë©”ì‹œì§€ ì…ë ¥ â†’ ì¹­ì°¬í•˜ê¸°",
      "í•™ìƒ: ëª¨ë‘ ì› ì „ì²´ê°€ ë™ì‹œì— ì¹­ì°¬ ì•Œë¦¼ ìˆ˜ì‹ !",
      "êµì‚¬: íƒ€ì´ë¨¸ ê¸°ëŠ¥ì„ í™œìš©í•˜ì—¬ ë‹¤ìŒ í™œë™ ì‹œê°„ ì•ˆë‚´",
    ]
  ));

  return out;
}

/** ì„¹ì…˜ 8: FAQ */
function createSection8() {
  const out = [];
  out.push(new Paragraph({ children: [new PageBreak()] }));
  out.push(...h1("8. FAQ (ìì£¼ ë¬»ëŠ” ì§ˆë¬¸)"));

  const faqs = [
    {
      q: "Q. í•™ìƒì´ PINì„ ìŠì–´ë²„ë ¸ì–´ìš”.",
      a: "êµì‚¬ê°€ ì„¤ì • > í•™ìƒ ê´€ë¦¬ì—ì„œ í•´ë‹¹ í•™ìƒì˜ PINì„ ì´ˆê¸°í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ˆê¸°í™” í›„ í•™ìƒì´ ë‹¤ì‹œ 4ìë¦¬ PINì„ ì„¤ì •í•©ë‹ˆë‹¤.",
    },
    {
      q: "Q. í•™ìƒì´ ì „í•™ì„ ì™”ì–´ìš”/ê°”ì–´ìš”.",
      a: "ì„¤ì • > í•™ìƒ ê´€ë¦¬ì—ì„œ í•™ìƒì„ ì¶”ê°€í•˜ê±°ë‚˜ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì‚­ì œ ì‹œ í•´ë‹¹ í•™ìƒì˜ ëª¨ë“  ë°ì´í„°(ì¹­ì°¬/ê°ì •/í«)ê°€ í•¨ê»˜ ì‚­ì œë˜ë¯€ë¡œ ì£¼ì˜í•˜ì„¸ìš”.",
    },
    {
      q: "Q. ì¸í„°ë„·ì´ ë¶ˆì•ˆì •í•œ êµì‹¤ì—ì„œë„ ì‚¬ìš©í•  ìˆ˜ ìˆë‚˜ìš”?",
      a: "ê¸°ë³¸ì ìœ¼ë¡œ ì¸í„°ë„· ì—°ê²°ì´ í•„ìš”í•˜ì§€ë§Œ, ì˜¤í”„ë¼ì¸ ìƒíƒœì—ì„œ ìˆ˜í–‰í•œ ì‘ì—…ì€ íì— ì €ì¥ë˜ì–´ ì—°ê²° ë³µêµ¬ ì‹œ ìë™ìœ¼ë¡œ ë™ê¸°í™”ë©ë‹ˆë‹¤.",
    },
    {
      q: "Q. í•œ êµì‚¬ê°€ ì—¬ëŸ¬ í•™ê¸‰ì„ ìš´ì˜í•  ìˆ˜ ìˆë‚˜ìš”?",
      a: "ë„¤, ê°€ëŠ¥í•©ë‹ˆë‹¤. ì„¤ì •ì—ì„œ í•™ê¸‰ì„ ì¶”ê°€ë¡œ ë§Œë“¤ê³ , í•™ê¸‰ ì „í™˜ ê¸°ëŠ¥ìœ¼ë¡œ ì˜¤ê°ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
    },
    {
      q: "Q. í•™ìƒì´ êµì‚¬ í™”ë©´ì„ ë³¼ ìˆ˜ ìˆë‚˜ìš”?",
      a: "ì•„ë‹ˆìš”. êµì‚¬ ëª¨ë“œì™€ í•™ìƒ ëª¨ë“œëŠ” ì™„ì „íˆ ë¶„ë¦¬ë˜ì–´ ìˆìŠµë‹ˆë‹¤. í•™ìƒì€ í•™ê¸‰ì½”ë“œ + ë²ˆí˜¸ + PINìœ¼ë¡œë§Œ ì ‘ì†í•˜ë©°, êµì‚¬ ê¸°ëŠ¥ì—ëŠ” ì ‘ê·¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.",
    },
    {
      q: "Q. í«ì˜ ì¢…ë¥˜ë¥¼ ë°”ê¿€ ìˆ˜ ìˆë‚˜ìš”?",
      a: "ì²˜ìŒ ì„ íƒí•œ í«ì€ ë³€ê²½í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì‹ ì¤‘í•˜ê²Œ ì„ íƒí•˜ë„ë¡ ì•ˆë‚´í•´ ì£¼ì„¸ìš”. (í–¥í›„ ì—…ë°ì´íŠ¸ì—ì„œ ë³€ê²½ ê¸°ëŠ¥ì´ ì¶”ê°€ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.)",
    },
    {
      q: "Q. ë°ì´í„°ëŠ” ì–´ë””ì— ì €ì¥ë˜ë‚˜ìš”?",
      a: "ëª¨ë“  ë°ì´í„°ëŠ” Google Firebase í´ë¼ìš°ë“œì— ì•ˆì „í•˜ê²Œ ì €ì¥ë©ë‹ˆë‹¤. ê¸°ê¸°ë¥¼ ë°”ê¿”ë„ ê°™ì€ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸í•˜ë©´ ë°ì´í„°ê°€ ìœ ì§€ë©ë‹ˆë‹¤.",
    },
    {
      q: "Q. í•™ê¸‰ì½”ë“œê°€ ìœ ì¶œë˜ì—ˆì–´ìš”.",
      a: "ì„¤ì • > í•™ê¸‰ì½”ë“œì—ì„œ ì½”ë“œë¥¼ ì¬ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ì „ ì½”ë“œëŠ” ì¦‰ì‹œ ë¬´íš¨í™”ë©ë‹ˆë‹¤.",
    },
    {
      q: "Q. ì¹­ì°¬ì„ ì˜ëª» ë³´ëƒˆì–´ìš”.",
      a: "ì¹­ì°¬ ê´€ë¦¬ ë©”ë‰´ì—ì„œ ìµœê·¼ ì¹­ì°¬ ê¸°ë¡ì„ í™•ì¸í•˜ê³  ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì‚­ì œ ì‹œ ê²½í—˜ì¹˜ë„ ì°¨ê°ë©ë‹ˆë‹¤.",
    },
  ];

  faqs.forEach(({ q, a }) => {
    out.push(new Paragraph({
      spacing: { before: 200, after: 80 },
      children: [new TextRun({ text: q, bold: true, color: C.dark, size: 22, font: FONT })],
    }));
    out.push(body(a));
  });

  return out;
}

/** ì„¹ì…˜ 9: ë² íƒ€ í…ŒìŠ¤íŠ¸ ì•ˆë‚´ */
function createSection9() {
  const out = [];
  out.push(new Paragraph({ children: [new PageBreak()] }));
  out.push(...h1("9. ë² íƒ€ í…ŒìŠ¤íŠ¸ ì•ˆë‚´"));
  out.push(body("Classpetì€ í˜„ì¬ ë² íƒ€ í…ŒìŠ¤íŠ¸ ê¸°ê°„ì…ë‹ˆë‹¤. ì—¬ëŸ¬ë¶„ì˜ ì†Œì¤‘í•œ í”¼ë“œë°±ì´ ë” ì¢‹ì€ ì„œë¹„ìŠ¤ë¥¼ ë§Œë“­ë‹ˆë‹¤!"));
  out.push(emptyLine());

  out.push(h2("ì ‘ì† ì •ë³´"));
  out.push(createTable(
    ["í•­ëª©", "ë‚´ìš©"],
    [
      [[b("ì ‘ì† ì£¼ì†Œ")], "https://classpet.netlify.app"],
      [[b("ë² íƒ€ ì ‘ê·¼ ì½”ë“œ")], [{ text: "classpet2026", bold: true, color: C.primary }]],
      [[b("ì§€ì› í™˜ê²½")], "Chrome, Safari (ëª¨ë°”ì¼/íƒœë¸”ë¦¿/PC ëª¨ë‘ ì§€ì›)"],
      [[b("ë² íƒ€ ê¸°ê°„")], "2026ë…„ 2ì›” ~ (ì¶”í›„ ê³µì§€)"],
    ],
    [3000, 6360]
  ));

  out.push(emptyLine());
  out.push(h2("ì¹´ì¹´ì˜¤í†¡ ê³µìœ ìš© ë©˜íŠ¸"));
  out.push(new Paragraph({
    spacing: { before: 120, after: 60 },
    border: {
      top: { style: BorderStyle.SINGLE, size: 1, color: C.tableBorder },
      bottom: { style: BorderStyle.SINGLE, size: 1, color: C.tableBorder },
      left: { style: BorderStyle.SINGLE, size: 1, color: C.tableBorder },
      right: { style: BorderStyle.SINGLE, size: 1, color: C.tableBorder },
    },
    shading: { fill: C.lightGray, type: ShadingType.CLEAR },
    indent: { left: 200, right: 200 },
    children: [new TextRun({ text: "[ë³µì‚¬í•˜ì—¬ ì‚¬ìš©í•˜ì„¸ìš”]", color: C.muted, size: 18, font: FONT, italics: true })],
  }));

  const kakaoLines = [
    "ğŸ¾ í•™ê¸‰ í« í‚¤ìš°ê¸° í”„ë¡œì íŠ¸, Classpetì„ ì†Œê°œí•©ë‹ˆë‹¤!",
    "",
    "ì¹­ì°¬í•˜ë©´ í•™ìƒ í«ì´ ìë¼ëŠ” í•™ê¸‰ ê²½ì˜ ì›¹ì•±ì´ì—ìš”.",
    "ì‹¤ì‹œê°„ ì¹­ì°¬ ì•Œë¦¼ + ê°ì • ì±„íŒ… + í« ì„±ì¥ê¹Œì§€!",
    "",
    "âœ… ì ‘ì†: https://classpet.netlify.app",
    "âœ… ë² íƒ€ ì½”ë“œ: classpet2026",
    "âœ… ì•± ì„¤ì¹˜ ì—†ì´ ì›¹ì—ì„œ ë°”ë¡œ ì‚¬ìš©",
    "",
    "ë² íƒ€ í…ŒìŠ¤íŠ¸ ì¤‘ì´ë¼ í”¼ë“œë°± ì£¼ì‹œë©´ ë°˜ì˜í• ê²Œìš” ğŸ™",
  ];
  kakaoLines.forEach(line => {
    out.push(new Paragraph({
      spacing: { after: 20 },
      border: {
        left: { style: BorderStyle.SINGLE, size: 1, color: C.tableBorder },
        right: { style: BorderStyle.SINGLE, size: 1, color: C.tableBorder },
        ...(line === kakaoLines[kakaoLines.length - 1] ? { bottom: { style: BorderStyle.SINGLE, size: 1, color: C.tableBorder } } : {}),
      },
      shading: { fill: C.lightGray, type: ShadingType.CLEAR },
      indent: { left: 200, right: 200 },
      children: line
        ? [new TextRun({ text: `  ${line}`, size: 22, font: FONT, color: C.body })]
        : [new TextRun({ text: " ", size: 22, font: FONT })],
    }));
  });

  out.push(emptyLine());
  out.push(h2("í”¼ë“œë°± ì²´í¬ë¦¬ìŠ¤íŠ¸"));
  out.push(body("ì•„ë˜ í•­ëª©ì„ í™•ì¸í•˜ì‹œê³ , ë¶ˆí¸í•œ ì ì´ë‚˜ ê°œì„  ì‚¬í•­ì„ ììœ ë¡­ê²Œ ì•Œë ¤ì£¼ì„¸ìš”."));
  out.push(emptyLine());

  const checkItems = [
    "ë¡œê·¸ì¸/íšŒì›ê°€ì…ì´ ì›í™œí–ˆë‚˜ìš”?",
    "í•™ê¸‰ ë§Œë“¤ê¸° & í•™ìƒ ë“±ë¡ì´ ì‰¬ì› ë‚˜ìš”?",
    "í•™ê¸‰ì½”ë“œ ê³µìœ  ë°©ì‹ì´ í¸ë¦¬í–ˆë‚˜ìš”?",
    "ë¹ ë¥¸ ì¹­ì°¬ ê¸°ëŠ¥ì´ ì§ê´€ì ì´ì—ˆë‚˜ìš”?",
    "í•™ìƒ ê¸°ê¸°ì— ì¹­ì°¬ ì•Œë¦¼ì´ ì˜ ì „ë‹¬ë˜ì—ˆë‚˜ìš”?",
    "ê°ì • ì²´í¬ & ì±„íŒ… ê¸°ëŠ¥ì´ ìœ ìš©í–ˆë‚˜ìš”?",
    "í« ì„±ì¥ ì‹œìŠ¤í…œì´ í•™ìƒ ë™ê¸°ë¶€ì—¬ì— ë„ì›€ì´ ë˜ì—ˆë‚˜ìš”?",
    "ì „ë°˜ì ì¸ í™”ë©´ ë””ìì¸ì´ ë³´ê¸° í¸í–ˆë‚˜ìš”?",
    "ë¡œë”© ì†ë„ë‚˜ ë°˜ì‘ ì†ë„ì— ë¬¸ì œëŠ” ì—†ì—ˆë‚˜ìš”?",
    "ê·¸ ì™¸ ì¶”ê°€ë˜ì—ˆìœ¼ë©´ í•˜ëŠ” ê¸°ëŠ¥ì´ ìˆë‚˜ìš”?",
  ];

  checkItems.forEach(item => {
    out.push(body(`â˜  ${item}`, { indent: { left: 360 } }));
  });

  out.push(emptyLine());
  out.push(body([b("í”¼ë“œë°± ì „ë‹¬ ë°©ë²•:")]));
  out.push(body([b("  1. êµ¬ê¸€ ì„¤ë¬¸ì§€: "), "ì•„ë˜ ë§í¬ì—ì„œ ìƒì„¸ í”¼ë“œë°±ì„ ë‚¨ê²¨ì£¼ì„¸ìš”. (ê°€ì¥ ì¶”ì²œ!)"], { indent: { left: 360 } }));
  out.push(body("      â†’ ê¸°ëŠ¥/UI/ì ‘ê·¼ì„±/êµ¬ë… ì˜í–¥ ë“± í•­ëª©ë³„ ì²´ê³„ì  í‰ê°€", { indent: { left: 360 } }));
  out.push(body("  2. ì¹´ì¹´ì˜¤í†¡ ë˜ëŠ” ë¬¸ìë¡œ ììœ ë¡­ê²Œ ë³´ë‚´ì£¼ì„¸ìš”.", { indent: { left: 360 } }));
  out.push(body("  3. ìŠ¤í¬ë¦°ìƒ·ê³¼ í•¨ê»˜ ë³´ë‚´ì£¼ì‹œë©´ ë”ìš± ë„ì›€ì´ ë©ë‹ˆë‹¤.", { indent: { left: 360 } }));

  out.push(emptyLine());
  out.push(emptyLine());
  out.push(new Paragraph({
    alignment: AlignmentType.CENTER,
    spacing: { before: 400 },
    children: [new TextRun({ text: "ê°ì‚¬í•©ë‹ˆë‹¤! ğŸ¾", bold: true, color: C.primary, size: 28, font: FONT })],
  }));
  out.push(new Paragraph({
    alignment: AlignmentType.CENTER,
    spacing: { after: 200 },
    children: [new TextRun({ text: "Classpetê³¼ í•¨ê»˜ ì¦ê±°ìš´ í•™ê¸‰ ê²½ì˜ì„ ì‹œì‘í•˜ì„¸ìš”.", color: C.body, size: 22, font: FONT })],
  }));

  return out;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// 4. ë¬¸ì„œ ì¡°ë¦½
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const doc = new Document({
  styles: {
    default: {
      document: {
        run: { font: FONT, size: 22, color: C.body },
      },
    },
  },
  numbering: {
    config: [
      {
        reference: "bullet-list",
        levels: [{
          level: 0, format: LevelFormat.BULLET, text: "\u2022", alignment: AlignmentType.LEFT,
          style: { paragraph: { indent: { left: 720, hanging: 360 } } },
        }],
      },
    ],
  },
  sections: [
    // ì„¹ì…˜ 1: í‘œì§€ (Header/Footer ìˆ¨ê¹€)
    createCoverPage(),
    // ì„¹ì…˜ 2: ë‚˜ë¨¸ì§€ ëª¨ë“  ë‚´ìš©
    {
      properties: {
        page: {
          margin: { top: 1440, right: 1440, bottom: 1440, left: 1440 },
        },
      },
      headers: {
        default: new Header({
          children: [
            new Paragraph({
              alignment: AlignmentType.RIGHT,
              children: [
                new TextRun({ text: "Classpet ì‚¬ìš© ê°€ì´ë“œ", italics: true, color: C.muted, size: 16, font: FONT }),
              ],
            }),
          ],
        }),
      },
      footers: {
        default: new Footer({
          children: [
            new Paragraph({
              alignment: AlignmentType.CENTER,
              children: [
                new TextRun({ text: "- ", color: C.muted, size: 18, font: FONT }),
                new TextRun({ children: [PageNumber.CURRENT], color: C.muted, size: 18, font: FONT }),
                new TextRun({ text: " -", color: C.muted, size: 18, font: FONT }),
              ],
            }),
          ],
        }),
      },
      children: [
        ...createTocSection(),
        ...createSection0(),
        ...createSection1(),
        ...createSection2(),
        ...createSection3(),
        ...createSection4(),
        ...createSection5(),
        ...createSection6(),
        ...createSection7(),
        ...createSection8(),
        ...createSection9(),
      ],
    },
  ],
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// 5. íŒŒì¼ ìƒì„±
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const buffer = await Packer.toBuffer(doc);
const __dirname = new URL(".", import.meta.url).pathname;
const outputPath = __dirname + "classpet-ì‚¬ìš©ê°€ì´ë“œ.docx";
fs.writeFileSync(outputPath, buffer);
console.log(`âœ… ìƒì„± ì™„ë£Œ: ${outputPath}`);
console.log(`   íŒŒì¼ í¬ê¸°: ${(buffer.length / 1024).toFixed(1)} KB`);
