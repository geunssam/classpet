# 학생/교사 페이지 신규 기능 구현 계획

## 개요

### 학생 페이지 (2가지)
1. **메시지 기록** - 캘린더로 날짜별 감정/답장 기록 조회
2. **받은 칭찬** - 교사가 보낸 칭찬을 날짜별/카테고리별 조회

### 교사 페이지 (1가지)
3. **칭찬 관리** - 칭찬 카테고리 추가/삭제/수정 + 칭찬 보내기 통합

---

## 수정 대상 파일

| 파일 | 작업 내용 |
|------|----------|
| `js/components/StudentMode.js` | 탭 UI 추가 (마음 보내기 / 기록 보기) |
| `js/components/StudentPraise.js` | **신규 생성** - 학생용 받은 칭찬 페이지 |
| `js/components/PraiseManagement.js` | **신규 생성** - 교사용 칭찬 관리 페이지 |
| `js/store.js` | 칭찬 카테고리 CRUD 메서드 추가 |
| `js/router.js` | `student-praise`, `praise` 라우트 추가 |
| `js/app.js` | 새 라우트 등록 + import |
| `index.html` | studentNav에 "받은 칭찬", teacherNav에 "칭찬" 메뉴 추가 |

---

## 기능 1: 메시지 기록 (StudentMode.js 내 탭) - 카톡 스타일

### UI 구조 (카카오톡 대화창 스타일)
```
┌─────────────────────────────────────┐
│  [💝 마음 보내기]  [📜 기록 보기]    │  ← 탭 전환
├─────────────────────────────────────┤
│  ◀  1월 26일 (일)  ▶                │  ← 날짜 네비게이션
├─────────────────────────────────────┤
│                                     │
│  ┌────────────────┐                │  ← 내 메시지 (오른쪽)
│  │ 😄 아주 좋아요!│        오전 9:30│
│  │ 체육시간 재미있었어요           │
│  └────────────────┘                │
│                                     │
│        ┌────────────────┐          │  ← 선생님 답장 (왼쪽)
│ 오전 10:15│ 💬 선생님     │          │
│        │ 정말 기뻤구나~ │          │
│        │ 잘했어! 👍    │          │
│        └────────────────┘          │
│                                     │
│  ┌────────────────┐                │
│  │ 😢 안 좋아요   │        오후 2:00│
│  │ 친구랑 싸웠어요 ㅠㅠ            │
│  └────────────────┘                │
│                                     │
│        ┌────────────────┐          │
│ 오후 3:30│ 💬 선생님     │          │
│        │ 힘들었겠다...  │          │
│        │ 선생님한테 얘기해줘 💕   │
│        └────────────────┘          │
│                                     │
│  ─────── 이전 기록 더보기 ───────   │
│                                     │
└─────────────────────────────────────┘
```

### 구현 내용
1. **카톡 스타일 채팅 UI**
   - 내 메시지: 오른쪽 정렬 (파란색/보라색 말풍선)
   - 선생님 답장: 왼쪽 정렬 (회색 말풍선)
   - 시간 표시: 말풍선 옆에 작게

2. **날짜 네비게이션**
   - 좌우 화살표로 날짜 이동
   - 오늘 날짜 기본 선택
   - 기록이 없으면 "기록이 없어요" 표시

3. **스크롤**
   - 위아래 스크롤 가능
   - 최신 메시지가 아래에 표시
   - "이전 기록 더보기" 버튼 (페이지네이션)

4. **메시지 그룹핑**
   - 감정 메시지 + 답장을 하나의 대화 쌍으로 표시
   - 답장이 없으면 답장 영역 생략

### 데이터 조회
```javascript
// 특정 날짜의 감정 기록 (시간순 정렬)
const emotions = store.getEmotionLog()
    .filter(e => e.studentId === studentId && e.timestamp.startsWith('2025-01-26'))
    .sort((a, b) => new Date(a.timestamp) - new Date(b.timestamp));
```

---

## 기능 2: 받은 칭찬 (새 페이지)

### UI 구조
```
┌─────────────────────────────────────┐
│ [전체][🎯][📚][💡][🎨][🤝][🏠]     │  ← 카테고리 필터 (가로 스크롤)
├─────────────────────────────────────┤
│      ◀  2025년 1월  ▶              │  ← 월 네비게이션
├─────────────────────────────────────┤
│  📅 1월 26일                        │
│  ┌─────────────────────────────┐   │
│  │ 🎯 자기관리      +10 EXP   │   │
│  │ 🤝 협력적소통    +10 EXP   │   │
│  └─────────────────────────────┘   │
│                                     │
│  📅 1월 25일                        │
│  ┌─────────────────────────────┐   │
│  │ 📚 지식정보      +10 EXP   │   │
│  └─────────────────────────────┘   │
└─────────────────────────────────────┘
```

### 구현 내용
1. 새 라우트: `student-praise`
2. 카테고리 필터 탭 (6개 + 전체)
3. 월 단위 네비게이션
4. 날짜별 그룹핑된 칭찬 목록

### 데이터 조회
```javascript
// 학생의 칭찬 목록 (카테고리/월 필터 가능)
const praises = store.getPraisesByStudent(studentId)
    .filter(p => !category || p.category === category)
    .filter(p => p.timestamp.startsWith('2025-01'));
```

---

## 기능 3: 교사용 칭찬 관리 (새 페이지)

### UI 구조
```
┌─────────────────────────────────────┐
│ [카테고리 관리]  [칭찬 보내기]       │  ← 탭 전환
├─────────────────────────────────────┤
│                                     │
│  📋 칭찬 카테고리 목록              │
│  ┌─────────────────────────────┐   │
│  │ 🎯 자기관리   10 EXP  [✏️][🗑️]│  │
│  │ 📚 지식정보   10 EXP  [✏️][🗑️]│  │
│  │ 💡 창의적사고 10 EXP  [✏️][🗑️]│  │
│  │ ...                          │   │
│  └─────────────────────────────┘   │
│                                     │
│  [+ 카테고리 추가]  [기본값 복원]    │
│                                     │
└─────────────────────────────────────┘
```

### 구현 내용

**1. 칭찬 카테고리 CRUD**
- 추가: 이모지 선택 + 이름 입력 + 경험치 설정
- 수정: 기존 카테고리 편집
- 삭제: 확인 후 삭제 (기존 칭찬 기록은 유지)
- 기본값 복원: 6개 기본 카테고리로 리셋

**2. 칭찬 보내기 탭**
- 기존 QuickPraise.js의 기능을 통합
- 학생 선택 → 카테고리 선택 → 칭찬 보내기

### store.js 확장
```javascript
// 새 저장소 키
STORAGE_KEYS.PRAISE_CATEGORIES = 'classpet_praise_categories'

// 새 메서드들
getPraiseCategories()           // 커스텀 카테고리 반환 (없으면 기본값)
savePraiseCategories(cats)      // 저장 + Firebase 동기화
addPraiseCategory({icon, name, exp})
updatePraiseCategory(key, {icon, name, exp})
deletePraiseCategory(key)
resetPraiseCategories()         // 기본값으로 복원
```

### 데이터 구조
```javascript
// localStorage: classpet_praise_categories
{
    "selfManagement": { icon: "🎯", name: "자기관리", exp: 10, order: 0 },
    "knowledge": { icon: "📚", name: "지식정보", exp: 10, order: 1 },
    "custom_1": { icon: "⭐", name: "발표왕", exp: 15, order: 6 },
    ...
}
```

---

## 네비게이션 메뉴 변경

### 학생 네비게이션
**현재 (3개)**: 마음 보내기 | 주간 시간표 | 펫도감
**변경 후 (4개)**: 마음 | 받은 칭찬 | 시간표 | 펫도감

### 교사 네비게이션
**현재 (5개)**: 홈 | 시간표 | 펫농장 | 마음 | 통계
**변경 후 (6개)**: 홈 | 시간표 | 펫농장 | 마음 | 칭찬 | 통계

---

## 구현 순서

### Phase 1: 교사 칭찬 관리 (먼저)
1. **store.js 확장** - 칭찬 카테고리 CRUD 메서드 추가
2. **PraiseManagement.js 생성** - 교사용 칭찬 관리 페이지
3. **router.js 수정** - `praise` 라우트 추가
4. **app.js 수정** - 라우트 등록 + import
5. **index.html 수정** - teacherNav에 "칭찬" 메뉴 추가

### Phase 2: 학생 기능
6. **StudentPraise.js 생성** - 학생용 받은 칭찬 페이지
7. **StudentMode.js 수정** - 내부 탭 UI + 기록 보기 뷰
8. **router.js 수정** - `student-praise` 라우트 추가
9. **index.html 수정** - studentNav에 "받은 칭찬" 메뉴 추가

### Phase 3: 테스트
10. **통합 테스트** - 교사→학생 칭찬 흐름 확인

---

## 검증 방법

### 교사 페이지
1. 상단바에 6개 메뉴 표시 확인 (홈, 시간표, 펫농장, 마음, 칭찬, 통계)
2. 칭찬 탭 → 카테고리 관리 화면 표시
3. 카테고리 추가/수정/삭제 작동 확인
4. 칭찬 보내기 탭에서 커스텀 카테고리 반영 확인

### 학생 페이지
5. 상단바에 4개 메뉴 표시 확인 (마음, 받은 칭찬, 시간표, 펫도감)
6. 마음 탭에서 [기록 보기] 클릭 → 캘린더 + 메시지 목록
7. 받은 칭찬 탭 → 교사가 보낸 칭찬 목록 (커스텀 카테고리 포함)
8. 모바일 햄버거 메뉴도 정상 작동
